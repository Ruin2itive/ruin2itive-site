<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="light" />

  <title>ruin2itive.org</title>
  <meta name="description" content="Independent, self-hosted hub — signals, systems, memory." />

  <style>
    :root{
      --paper:#ffffff;

      --ink:#111111;
      --muted:#5a5852;
      --rule:#ddd6cc;

      --red:#8b1f1f;

      /* Card readability vs background visibility */
      --card: rgba(255,255,255,.90);
      --cardHead: rgba(255,255,255,.82);

      --radius:18px;

      --shadow: 0 10px 26px rgba(0,0,0,.12);
      --shadowSoft: 0 6px 18px rgba(0,0,0,.10);

      --max: 1240px;
      --g: 22px;

      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bot: env(safe-area-inset-bottom, 0px);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-serif, Georgia, "Times New Roman", Times, serif;
      color:var(--ink);
      background: var(--paper);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    a{ color:inherit; text-decoration:none; }
    a:hover{ text-decoration:underline; }

    /* =========================
       HERO (ELEPHANT BACKGROUND)
       ========================= */
    .hero{
      position:relative;
      overflow:hidden;
      background: var(--paper);
      padding-top: calc(10px + var(--safe-top));
      padding-bottom: 26px;
      min-height: clamp(210px, 34vh, 420px);
      border-bottom: 1px solid var(--rule);
    }

    .hero-media{
      position:absolute;
      inset:-80px;
      z-index:0;
      pointer-events:none;

      /* ✅ Force the elephant */
      background-image:
        url("assets/elephant-third-eye.webp"),
        url("assets/elephant-third-eye.png"),
        url("assets/elephant-bg.PNG");
      background-position: center 48%;
      background-size: cover;
      background-repeat:no-repeat;

      /* Make it bold enough to read as identity */
      opacity: .78;
      filter: contrast(1.22) saturate(1.08);
      transform: translateZ(0);
    }

    /* subtle paper/ink veil to keep it classy */
    .hero::before{
      content:"";
      position:absolute;
      inset:0;
      z-index:1;
      background:
        radial-gradient(1200px 500px at 50% 10%,
          rgba(255,255,255,.20),
          rgba(255,255,255,.55) 55%,
          rgba(255,255,255,.92) 100%);
      pointer-events:none;
    }

    /* fade to pure paper so cards always read */
    .hero::after{
      content:"";
      position:absolute;
      inset:0;
      z-index:2;
      background:
        linear-gradient(to bottom,
          rgba(255,255,255,0) 0%,
          rgba(255,255,255,.12) 48%,
          rgba(255,255,255,.88) 100%);
      pointer-events:none;
    }

    /* =========================
       MASTHEAD (CLEAN NEWSPAPER)
       ========================= */
    .mast{
      position:relative;
      z-index:3;
      max-width: var(--max);
      margin: 0 auto;
      padding: 8px 18px 0;
      text-align:center;
    }

    .kickerline{
      font-size: 10px;
      letter-spacing: .34em;
      text-transform: uppercase;
      color: rgba(0,0,0,.60);
      margin: 0 0 10px;
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }

    .title{
      margin:0;
      font-size: clamp(28px, 3.2vw, 44px);
      letter-spacing: -0.012em;
      color: rgba(0,0,0,.88);
      line-height: 1.02;
      display:inline-block;
      padding: 8px 14px;
      border-radius: 999px;

      /* “ink stamp” glass — reads on any background */
      background: rgba(255,255,255,.78);
      border: 1px solid rgba(0,0,0,.10);
      box-shadow: var(--shadowSoft);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }

    .tagline{
      margin-top: 10px;
      font-size: 11px;
      letter-spacing: .24em;
      text-transform: uppercase;
      color: rgba(0,0,0,.60);
    }

    .mast-rule{
      max-width: var(--max);
      margin: 16px auto 0;
      padding: 0 18px;
    }
    .mast-rule .line{
      height:1px;
      background: var(--rule);
      position:relative;
    }
    .mast-rule .line::after{
      content:"";
      position:absolute;
      left:50%;
      top:-1px;
      width: 92px;
      height: 3px;
      transform: translateX(-50%);
      background: rgba(139,31,31,.28);
      border-radius: 999px;
    }

    /* =========================
       LAYOUT
       ========================= */
    .wrap{
      position:relative;
      max-width: var(--max);
      margin: 0 auto;
      padding: 0 18px calc(30px + var(--safe-bot));
    }

    main{
      position:relative;
      margin-top: clamp(-92px, -8vh, -64px);
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: var(--g);
      align-items:start;
    }

    @media (min-width: 920px){
      .grid{ grid-template-columns: 1.05fr 1.0fr; }
    }

    /* =========================
       CARDS
       ========================= */
    .card{
      background: var(--card);
      border: 1px solid rgba(0,0,0,.12);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }

    .head{
      padding: 14px 18px 10px;
      background: var(--cardHead);
      border-bottom: 1px solid var(--rule);
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap: 10px;
    }

    .kicker{
      font-size: 11px;
      letter-spacing: .34em;
      text-transform: uppercase;
      color: var(--red);
      font-weight: 800;
      line-height: 1.1;
    }

    .mini{
      font-size: 10px;
      letter-spacing: .18em;
      text-transform: uppercase;
      color: rgba(0,0,0,.52);
      white-space:nowrap;
    }

    .body{ padding: 12px 18px 14px; }

    /* Projects list */
    .proj{
      padding: 10px 0;
      border-bottom: 1px solid rgba(0,0,0,.10);
    }
    .proj:last-child{ border-bottom:none; padding-bottom:6px; }

    .proj .name{
      font-size: clamp(28px, 2.6vw, 40px);
      line-height: 1;
      margin: 0 0 10px;
      letter-spacing: -0.02em;
    }

    .pills{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      padding-bottom: 2px;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      border: 1px solid rgba(0,0,0,.22);
      color: rgba(0,0,0,.82);
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 10px;
      letter-spacing: .22em;
      text-transform: uppercase;
      background: rgba(255,255,255,.78);
      white-space:nowrap;
    }

    /* Feed items */
    .item{
      display:block;
      padding: 11px 0;
      border-bottom: 1px solid rgba(0,0,0,.10);
    }
    .item:last-child{ border-bottom:none; padding-bottom:6px; }

    .item h3{
      margin:0 0 7px;
      font-size: 16px;
      line-height: 1.18;
      letter-spacing: .01em;
    }

    .meta{
      display:flex;
      gap: 8px;
      align-items:center;
      flex-wrap:wrap;
      color: var(--muted);
      font-size: 11px;
    }

    .stamp{
      display:inline-flex;
      align-items:center;
      padding: 3px 9px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,.18);
      background: rgba(255,255,255,.86);
      font-size: 9px;
      letter-spacing: .16em;
      text-transform: uppercase;
      color: rgba(0,0,0,.64);
    }
    .stamp.red{
      border-color: rgba(139,31,31,.40);
      color: rgba(139,31,31,.90);
    }

    /* Empty / loading blocks */
    .feature{ padding: 12px 0 8px; }
    .headline{ font-size: 16px; margin:0 0 6px; }
    .sub{
      color: var(--muted);
      margin:0 0 10px;
      font-size: 12px;
      line-height: 1.35;
    }
    .status{
      color: rgba(0,0,0,.58);
      font-size: 10px;
      letter-spacing: .16em;
      text-transform: uppercase;
    }

    /* Skeleton loading */
    .skel{
      border-radius: 10px;
      height: 12px;
      background: linear-gradient(
        90deg,
        rgba(0,0,0,.06),
        rgba(0,0,0,.12),
        rgba(0,0,0,.06)
      );
      background-size: 220% 100%;
      animation: shimmer 1.2s infinite linear;
    }
    .skel.t{ height: 18px; border-radius: 12px; }
    .skel.s{ height: 12px; width: 78%; }
    .skel.m{ height: 12px; width: 54%; }

    @keyframes shimmer{
      0%{ background-position: 0% 0; }
      100%{ background-position: 220% 0; }
    }

    /* Footer */
    footer{
      max-width: var(--max);
      margin: 0 auto;
      padding: 18px 18px calc(22px + var(--safe-bot));
      color: rgba(0,0,0,.56);
      font-size: 11px;
      letter-spacing: .10em;
      text-transform: uppercase;
      text-align:center;
    }

    /* =========================
       MOBILE TUNING (IPHONE)
       ========================= */
    @media (max-width: 520px){
      :root{ --g: 16px; }

      .hero{
        min-height: 240px;
        padding-bottom: 18px;
      }
      .hero-media{
        inset:-60px;
        background-position: center 42%;
        opacity: .82;
      }

      .kickerline{ letter-spacing: .26em; }
      .tagline{ letter-spacing: .18em; }

      main{ margin-top: -58px; }
      .head{ padding: 12px 14px 9px; }
      .body{ padding: 10px 14px 12px; }

      .proj .name{ font-size: 30px; }
      .pill{ font-size: 9px; padding: 6px 10px; letter-spacing: .18em; }
    }
  </style>
</head>

<body>
  <header class="hero" aria-label="ruin2itive hero background">
    <div class="hero-media" aria-hidden="true"></div>

    <div class="mast">
      <div class="kickerline">Reliability • Open Source • Independent</div>
      <h1 class="title">ruin2itive</h1>
      <div class="tagline">Signals • Systems • Memory</div>
    </div>

    <div class="mast-rule" aria-hidden="true">
      <div class="line"></div>
    </div>
  </header>

  <div class="wrap">
    <main>
      <section class="grid">
        <!-- LEFT -->
        <article class="card" aria-label="Projects / The Code">
          <div class="head">
            <div class="kicker">Projects / The Code</div>
            <div class="mini" id="projects-updated">Standby</div>
          </div>
          <div class="body" id="projects-root">
            <div class="feature">
              <div class="headline"><div class="skel t"></div></div>
              <div class="sub">
                <div class="skel s" style="margin:10px 0 8px;"></div>
                <div class="skel m"></div>
              </div>
              <div class="status">Status: loading</div>
            </div>
          </div>
        </article>

        <!-- RIGHT -->
        <article class="card" aria-label="Markets / Crypto">
          <div class="head">
            <div class="kicker">Markets / Crypto</div>
            <div class="mini" id="decrypt-updated">Standby</div>
          </div>
          <div class="body" id="decrypt-root">
            <div class="feature">
              <div class="headline"><div class="skel t"></div></div>
              <div class="sub">
                <div class="skel s" style="margin:10px 0 8px;"></div>
                <div class="skel m"></div>
              </div>
              <div class="status">Status: loading</div>
            </div>
          </div>

          <div class="head" style="border-top:1px solid var(--rule);">
            <div class="kicker">Hacker News</div>
            <div class="mini" id="hn-updated">Standby</div>
          </div>
          <div class="body" id="hn-root">
            <div class="feature">
              <div class="headline">Quiet</div>
              <div class="sub">This section fills from <span class="stamp">home.json</span> when available.</div>
              <div class="status">Status: standby</div>
            </div>
          </div>
        </article>
      </section>
    </main>
  </div>

  <footer>
    ruin2itive.org — signals • systems • memory
  </footer>

  <script>
    function esc(s){
      return String(s ?? "")
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    function nowBust(){ return String(Date.now()); }

    function stamp(text, variant){
      const cls = variant === "source" ? "stamp red" : "stamp";
      return `<span class="${cls}">${esc(text)}</span>`;
    }

    async function fetchJson(url){
      const r = await fetch(url, { cache: "no-store" });
      if (!r.ok) throw new Error(`HTTP ${r.status}`);
      return await r.json();
    }

    function setMini(id, text){
      const el = document.getElementById(id);
      if (!el) return;
      el.textContent = text || "Standby";
    }

    function renderError(root, title, detail){
      root.innerHTML = `
        <div class="feature">
          <div class="headline">${esc(title)}</div>
          <div class="sub">${esc(detail)}</div>
          <div class="status">Status: error</div>
        </div>
      `;
    }

    function renderProjects(data){
      const root = document.getElementById("projects-root");
      const groups = data?.groups;

      const u = data?.updated_iso ? new Date(data.updated_iso) : null;
      const uText = (u && !isNaN(u.getTime())) ? `Updated: ${u.toLocaleString()}` : "Live";
      setMini("projects-updated", uText);

      if (!Array.isArray(groups) || groups.length === 0){
        root.innerHTML = `
          <div class="feature">
            <div class="headline">No projects</div>
            <div class="sub">Your projects.json has no groups.</div>
            <div class="status">Status: empty</div>
          </div>
        `;
        return;
      }

      const html = groups.map(g => {
        const name = g?.title || g?.name || "project";
        const links = Array.isArray(g?.links) ? g.links : [];

        const pills = links.map(l => {
          const label = l?.label || "link";
          const url = l?.href || l?.url || "#";
          return `<a class="pill" href="${esc(url)}" target="_blank" rel="noopener">${esc(label)}</a>`;
        }).join("");

        return `
          <div class="proj">
            <div class="name">${esc(name)}</div>
            <div class="pills">${pills}</div>
          </div>
        `;
      }).join("");

      root.innerHTML = html;
    }

    function renderDecrypt(data){
      const root = document.getElementById("decrypt-root");
      const items = Array.isArray(data?.items) ? data.items : [];
      const updated = data?.updated ? new Date(data.updated) : null;

      const isSeed =
        (items[0]?.stamp === "SEED") ||
        (typeof data?.updated === "string" && data.updated.startsWith("1970-")) ||
        (!updated || isNaN(updated.getTime())) ||
        (updated && updated.getFullYear && updated.getFullYear() < 2000);

      const updatedText = (!isSeed && updated && !isNaN(updated.getTime()))
        ? `Updated: ${updated.toLocaleString()}`
        : "Seed (waiting on feed)";

      setMini("decrypt-updated", updatedText);

      const itemsHtml = items.slice(0, 5).map(it => {
        const title = it?.title || "Untitled";
        const url = it?.url || "#";
        const src = it?.source || "decrypt";
        const st = it?.stamp || "";

        return `
          <a class="item" href="${esc(url)}" target="_blank" rel="noopener">
            <h3>${esc(title)}</h3>
            <div class="meta">
              ${st ? stamp(st) : ""}
              ${stamp(src, "source")}
            </div>
          </a>
        `;
      }).join("");

      root.innerHTML = itemsHtml || `
        <div class="feature">
          <div class="headline">No items</div>
          <div class="sub">Your feed is empty.</div>
          <div class="status">Status: empty</div>
        </div>
      `;
    }

    function renderHNfromHomeJson(home){
      const root = document.getElementById("hn-root");
      const items = home?.sections?.hacker;

      const updated = home?.updated_iso ? new Date(home.updated_iso) : null;
      const updatedText = (updated && !isNaN(updated.getTime()))
        ? `Updated: ${updated.toLocaleString()}`
        : "Standby";

      setMini("hn-updated", updatedText);

      if (!Array.isArray(items) || items.length === 0) return;

      const html = items.slice(0, 10).map(it => {
        const title = it?.title || "Untitled";
        const url = it?.url || "#";
        return `
          <a class="item" href="${esc(url)}" target="_blank" rel="noopener">
            <h3>${esc(title)}</h3>
            <div class="meta">${stamp("hn", "source")}${stamp("newest")}</div>
          </a>
        `;
      }).join("");

      root.innerHTML = html;
    }

    async function boot(){
      try{
        const projects = await fetchJson(`data/projects.json?${nowBust()}`);
        renderProjects(projects);
      }catch(e){
        setMini("projects-updated", "Error");
        renderError(
          document.getElementById("projects-root"),
          "Projects",
          `Could not load data/projects.json (${e.message}).`
        );
      }

      try{
        const decrypt = await fetchJson(`data/decrypt.json?${nowBust()}`);
        renderDecrypt(decrypt);
      }catch(e){
        setMini("decrypt-updated", "Error");
        renderError(
          document.getElementById("decrypt-root"),
          "Decrypt",
          `Could not load data/decrypt.json (${e.message}).`
        );
      }

      try{
        const home = await fetchJson(`data/home.json?${nowBust()}`);
        renderHNfromHomeJson(home);
      }catch(_e){
        // silent
      }
    }

    boot();
  </script>
</body>
</html>
