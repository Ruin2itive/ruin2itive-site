<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="light dark" />

  <title>ruin2itive.org</title>
  <meta name="description" content="Independent, self-hosted hub — signals, systems, memory." />

  <style>
    :root{
      /* paper system */
      --paper:#fbfaf7;
      --paper2:#ffffff;
      --ink:#111;
      --muted:#5a5852;
      --rule:#ded6cc;
      --rule2:#eee7df;

      /* brand */
      --red:#8b1f1f;

      /* geometry */
      --radius:16px;
      --max: 1320px;
      --g: 20px;

      /* safe areas */
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bot: env(safe-area-inset-bottom, 0px);

      /* shadows (tight + editorial, not “app-y”) */
      --shadow: 0 14px 40px rgba(0,0,0,.10);
      --shadowSoft: 0 10px 28px rgba(0,0,0,.08);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      color:var(--ink);
      background: var(--paper);
      font-family: ui-serif, Georgia, "Times New Roman", Times, serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    a{ color:inherit; text-decoration:none; }
    a:hover{ text-decoration:underline; }

    /* subtle paper grain (no images) */
    body::before{
      content:"";
      position:fixed;
      inset:0;
      pointer-events:none;
      background:
        radial-gradient(900px 520px at 18% 8%, rgba(0,0,0,.035), transparent 60%),
        radial-gradient(900px 520px at 84% 0%, rgba(0,0,0,.025), transparent 60%),
        linear-gradient(to bottom, rgba(0,0,0,.02), transparent 18%, rgba(0,0,0,.02));
      opacity:.55;
      z-index:0;
    }

    .wrap{
      position:relative;
      z-index:1;
      max-width: var(--max);
      margin:0 auto;
      padding: 0 18px calc(28px + var(--safe-bot));
    }

    /* =========================
       HERO MASTHEAD (CONTAINED)
       ========================= */
    .hero{
      position:relative;
      padding-top: calc(14px + var(--safe-top));
      padding-bottom: 18px;
      overflow:hidden;
      background: var(--paper2);
      border-bottom: 1px solid var(--rule);
    }

    /* background image is ONLY inside hero */
    .hero::before{
      content:"";
      position:absolute;
      inset:0;
      background-image:
        url("assets/elephant-third-eye.webp"),
        url("assets/elephant-third-eye.png"),
        url("assets/elephant-bg.PNG");
      background-repeat:no-repeat;
      background-size: cover;
      background-position: center 28%;
      filter: grayscale(1) contrast(1.2);
      opacity: .92;
      pointer-events:none;
      z-index:0;
      transform: scale(1.03);
    }

    /* editorial veil for readability */
    .hero::after{
      content:"";
      position:absolute;
      inset:0;
      background:
        radial-gradient(900px 420px at 50% 45%, rgba(255,255,255,.82), rgba(255,255,255,.55) 40%, rgba(255,255,255,.70) 60%, rgba(255,255,255,.96) 100%),
        linear-gradient(to bottom, rgba(255,255,255,.70) 0%, rgba(255,255,255,.82) 45%, rgba(255,255,255,1) 100%);
      pointer-events:none;
      z-index:0;
    }

    .mast{
      position:relative;
      z-index:1;
      text-align:center;
      padding: 10px 0 6px;
    }

    .kickerline{
      font-size: 10px;
      letter-spacing: .34em;
      text-transform: uppercase;
      color: rgba(0,0,0,.64);
      margin: 0 0 10px;
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }

    .nameplate{
      display:inline-block;
      padding: 12px 18px 10px;
      border-radius: 18px;
      border: 1px solid rgba(0,0,0,.10);
      background: rgba(255,255,255,.78);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      box-shadow: 0 10px 30px rgba(0,0,0,.10);
    }

    .title{
      margin:0;
      font-size: clamp(34px, 5vw, 64px);
      line-height: 1.0;
      letter-spacing: -0.03em;
      color: rgba(0,0,0,.92);
    }

    .tagline{
      margin: 9px 0 0;
      font-size: 11px;
      letter-spacing: .22em;
      text-transform: uppercase;
      color: rgba(0,0,0,.58);
    }

    .rules{
      margin-top: 16px;
      position:relative;
      z-index:1;
    }
    .rules .thin{
      height:1px;
      background: rgba(0,0,0,.16);
      max-width: 860px;
      margin: 0 auto;
    }
    .rules .thick{
      height:3px;
      background: rgba(139,31,31,.30);
      width: 130px;
      margin: 10px auto 0;
      border-radius: 999px;
    }

    .navstrip{
      display:flex;
      justify-content:center;
      gap: 12px;
      flex-wrap:wrap;
      padding: 14px 0 4px;
      margin: 0;
      list-style:none;
      position:relative;
      z-index:1;
    }
    .navstrip a{
      font-size: 10px;
      letter-spacing: .22em;
      text-transform: uppercase;
      color: rgba(0,0,0,.70);
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,.14);
      background: rgba(255,255,255,.78);
    }
    .navstrip a:hover{
      text-decoration:none;
      border-color: rgba(139,31,31,.38);
    }

    /* ======================
       FRONT PAGE LAYOUT
       ====================== */
    main{
      padding-top: 18px;
    }

    .edition{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 10px;
      padding: 10px 2px 14px;
      border-bottom: 1px solid var(--rule);
      margin-bottom: 18px;
      color: rgba(0,0,0,.64);
      font-size: 10px;
      letter-spacing: .24em;
      text-transform: uppercase;
    }

    .edition strong{
      letter-spacing: .18em;
      color: rgba(0,0,0,.78);
      font-weight: 700;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: var(--g);
      align-items:start;
    }
    @media (min-width: 900px){
      .grid{ grid-template-columns: 1fr 1fr; }
    }
    @media (min-width: 1280px){
      .grid{ grid-template-columns: 1fr 1fr 1fr; }
    }

    /* Cards */
    .card{
      background: rgba(255,255,255,.98);
      border: 1px solid rgba(0,0,0,.12);
      border-radius: var(--radius);
      box-shadow: var(--shadowSoft);
      overflow:hidden;
    }

    .head{
      padding: 14px 16px 10px;
      border-bottom: 1px solid var(--rule2);
      display:flex;
      justify-content:space-between;
      gap: 10px;
      align-items:flex-end;
      background: rgba(255,255,255,.99);
    }

    .kicker{
      font-size: 11px;
      letter-spacing: .34em;
      text-transform: uppercase;
      color: var(--red);
      font-weight: 900;
      line-height: 1.1;
    }

    .mini{
      font-size: 10px;
      letter-spacing: .18em;
      text-transform: uppercase;
      color: rgba(0,0,0,.52);
      white-space:nowrap;
    }

    .body{
      padding: 12px 16px 14px;
    }

    /* Projects list */
    .proj{
      padding: 10px 0;
      border-bottom: 1px solid rgba(0,0,0,.10);
    }
    .proj:last-child{ border-bottom:none; padding-bottom:6px; }

    .proj .name{
      font-size: clamp(24px, 2.3vw, 36px);
      line-height: 1.02;
      margin: 0 0 10px;
      letter-spacing: -0.02em;
    }

    .pills{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      border: 1px solid rgba(0,0,0,.20);
      color: rgba(0,0,0,.78);
      padding: 6px 11px;
      border-radius: 999px;
      font-size: 10px;
      letter-spacing: .20em;
      text-transform: uppercase;
      background: rgba(255,255,255,.96);
      white-space:nowrap;
    }

    /* Feed items */
    .item{
      display:block;
      padding: 12px 0;
      border-bottom: 1px solid rgba(0,0,0,.10);
    }
    .item:last-child{ border-bottom:none; padding-bottom:6px; }

    .item h3{
      margin:0 0 8px;
      font-size: 16px;
      line-height: 1.18;
      letter-spacing: .01em;
    }

    .meta{
      display:flex;
      gap: 8px;
      align-items:center;
      flex-wrap:wrap;
      color: var(--muted);
      font-size: 11px;
    }

    .stamp{
      display:inline-flex;
      align-items:center;
      padding: 3px 9px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,.18);
      background: rgba(255,255,255,.98);
      font-size: 9px;
      letter-spacing: .16em;
      text-transform: uppercase;
      color: rgba(0,0,0,.62);
    }
    .stamp.red{
      border-color: rgba(139,31,31,.40);
      color: rgba(139,31,31,.88);
    }

    .feature{ padding: 12px 0 8px; }
    .headline{ font-size: 16px; margin:0 0 6px; }
    .sub{
      color: var(--muted);
      margin:0 0 10px;
      font-size: 12px;
      line-height: 1.35;
    }
    .status{
      color: rgba(0,0,0,.56);
      font-size: 10px;
      letter-spacing: .16em;
      text-transform: uppercase;
    }

    .skel{
      border-radius: 10px;
      height: 12px;
      background: linear-gradient(
        90deg,
        rgba(0,0,0,.06),
        rgba(0,0,0,.12),
        rgba(0,0,0,.06)
      );
      background-size: 220% 100%;
      animation: shimmer 1.2s infinite linear;
    }
    .skel.t{ height: 18px; border-radius: 12px; }
    .skel.s{ height: 12px; width: 78%; }
    .skel.m{ height: 12px; width: 54%; }

    @keyframes shimmer{
      0%{ background-position: 0% 0; }
      100%{ background-position: 220% 0; }
    }

    footer{
      margin-top: 18px;
      border-top: 1px solid var(--rule);
      padding: 16px 0 calc(18px + var(--safe-bot));
      color: rgba(0,0,0,.56);
      font-size: 11px;
      letter-spacing: .10em;
      text-transform: uppercase;
      text-align:center;
    }

    /* Dark mode */
    @media (prefers-color-scheme: dark){
      :root{
        --paper:#0b0b0d;
        --paper2:#111114;
        --ink: rgba(255,255,255,.92);
        --muted: rgba(255,255,255,.64);
        --rule: rgba(255,255,255,.14);
        --rule2: rgba(255,255,255,.10);
      }

      body::before{
        background:
          radial-gradient(900px 520px at 18% 8%, rgba(255,255,255,.06), transparent 60%),
          radial-gradient(900px 520px at 84% 0%, rgba(255,255,255,.04), transparent 60%),
          linear-gradient(to bottom, rgba(255,255,255,.06), transparent 18%, rgba(255,255,255,.05));
        opacity:.55;
      }

      .hero::after{
        background:
          radial-gradient(900px 420px at 50% 45%, rgba(10,10,12,.40), rgba(10,10,12,.75) 60%),
          linear-gradient(to bottom, rgba(10,10,12,.75) 0%, rgba(10,10,12,.92) 100%);
      }

      .nameplate{
        border-color: rgba(255,255,255,.18);
        background: rgba(18,18,20,.55);
      }

      .title{ color: rgba(255,255,255,.96); }
      .tagline, .kickerline { color: rgba(255,255,255,.70); }

      .navstrip a{
        border-color: rgba(255,255,255,.18);
        background: rgba(18,18,20,.55);
        color: rgba(255,255,255,.74);
      }

      .card{
        background: rgba(16,16,18,.72);
        border-color: rgba(255,255,255,.14);
      }

      .head{
        background: rgba(16,16,18,.72);
        border-color: var(--rule2);
      }

      .pill{
        border-color: rgba(255,255,255,.22);
        background: rgba(18,18,20,.55);
        color: rgba(255,255,255,.80);
      }

      .stamp{
        background: rgba(18,18,20,.55);
        border-color: rgba(255,255,255,.20);
        color: rgba(255,255,255,.70);
      }

      footer{
        color: rgba(255,255,255,.62);
      }
    }

    /* ======================
       MOBILE TUNING
       ====================== */
    @media (max-width: 520px){
      :root{ --g: 14px; }
      .kickerline{ letter-spacing:.26em; }
      .title{ font-size: 40px; }
      .tagline{ letter-spacing:.18em; }
      .head{ padding: 12px 14px 9px; }
      .body{ padding: 10px 14px 12px; }
      .edition{ flex-direction:column; align-items:flex-start; gap: 6px; }
      .hero::before{ background-position: center 26%; }
      .nameplate{ padding: 10px 14px 8px; border-radius: 16px; }
    }
  </style>
</head>

<body>
  <header class="hero">
    <div class="wrap">
      <div class="mast">
        <div class="kickerline">Reliability • Open Source • Independent</div>

        <div class="nameplate">
          <h1 class="title">ruin2itive</h1>
          <div class="tagline">Signals • Systems • Memory</div>
        </div>

        <div class="rules" aria-hidden="true">
          <div class="thin"></div>
          <div class="thick"></div>
        </div>

        <ul class="navstrip" aria-label="Section index">
          <li><a href="#projects">Projects</a></li>
          <li><a href="#markets">Markets</a></li>
          <li><a href="#hacker">Hacker</a></li>
        </ul>
      </div>
    </div>
  </header>

  <div class="wrap">
    <main>
      <div class="edition" aria-label="Front page edition bar">
        <div><strong>FRONT PAGE</strong> • curated feeds • no noise</div>
        <div id="edition-time">Edition: loading…</div>
      </div>

      <section class="grid">
        <article class="card" id="projects" aria-label="Projects / The Code">
          <div class="head">
            <div class="kicker">Projects / The Code</div>
            <div class="mini" id="projects-updated">Standby</div>
          </div>
          <div class="body" id="projects-root">
            <div class="feature">
              <div class="headline"><div class="skel t"></div></div>
              <div class="sub">
                <div class="skel s" style="margin:10px 0 8px;"></div>
                <div class="skel m"></div>
              </div>
              <div class="status">Status: loading</div>
            </div>
          </div>
        </article>

        <article class="card" id="markets" aria-label="Markets / Crypto">
          <div class="head">
            <div class="kicker">Markets / Crypto</div>
            <div class="mini" id="decrypt-updated">Standby</div>
          </div>

          <div class="body" id="decrypt-root">
            <div class="feature">
              <div class="headline"><div class="skel t"></div></div>
              <div class="sub">
                <div class="skel s" style="margin:10px 0 8px;"></div>
                <div class="skel m"></div>
              </div>
              <div class="status">Status: loading</div>
            </div>
          </div>
        </article>

        <article class="card" id="hacker" aria-label="Hacker News">
          <div class="head">
            <div class="kicker">Hacker News</div>
            <div class="mini" id="hn-updated">Standby</div>
          </div>

          <div class="body" id="hn-root">
            <div class="feature">
              <div class="headline">Quiet</div>
              <div class="sub">This section fills from <span class="stamp">home.json</span> when available.</div>
              <div class="status">Status: standby</div>
            </div>
          </div>
        </article>
      </section>
    </main>

    <footer>
      ruin2itive.org — signals • systems • memory
    </footer>
  </div>

  <script>
    const fmt = { dateStyle: "medium", timeStyle: "short" };

    function esc(s){
      return String(s ?? "")
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    function nowBust(){ return String(Date.now()); }

    function stamp(text, variant){
      const cls = variant === "source" ? "stamp red" : "stamp";
      return `<span class="${cls}">${esc(text)}</span>`;
    }

    async function fetchJson(url){
      const r = await fetch(url, { cache: "no-store" });
      if (!r.ok) throw new Error(`HTTP ${r.status}`);
      return await r.json();
    }

    function setMini(id, text){
      const el = document.getElementById(id);
      if (!el) return;
      el.textContent = text || "Standby";
    }

    function renderError(root, title, detail){
      root.innerHTML = `
        <div class="feature">
          <div class="headline">${esc(title)}</div>
          <div class="sub">${esc(detail)}</div>
          <div class="status">Status: error</div>
        </div>
      `;
    }

    function renderProjects(data){
      const root = document.getElementById("projects-root");
      const groups = data?.groups;

      const u = data?.updated_iso ? new Date(data.updated_iso) : null;
      const uText = (u && !isNaN(u.getTime())) ? `Updated: ${u.toLocaleString(undefined, fmt)}` : "Live";
      setMini("projects-updated", uText);

      if (!Array.isArray(groups) || groups.length === 0){
        root.innerHTML = `
          <div class="feature">
            <div class="headline">No projects</div>
            <div class="sub">Your projects.json has no groups.</div>
            <div class="status">Status: empty</div>
          </div>
        `;
        return;
      }

      root.innerHTML = groups.map(g => {
        const name = g?.title || g?.name || "project";
        const links = Array.isArray(g?.links) ? g.links : [];

        const pills = links.map(l => {
          const label = l?.label || "link";
          const url = l?.href || l?.url || "#";
          return `<a class="pill" href="${esc(url)}" target="_blank" rel="noopener">${esc(label)}</a>`;
        }).join("");

        return `
          <div class="proj">
            <div class="name">${esc(name)}</div>
            <div class="pills">${pills}</div>
          </div>
        `;
      }).join("");
    }

    function renderDecrypt(data){
      const root = document.getElementById("decrypt-root");
      const items = Array.isArray(data?.items) ? data.items : [];
      const updated = data?.updated ? new Date(data.updated) : null;

      const isSeed =
        (items[0]?.stamp === "SEED") ||
        (typeof data?.updated === "string" && data.updated.startsWith("1970-")) ||
        (!updated || isNaN(updated.getTime())) ||
        (updated && updated.getFullYear && updated.getFullYear() < 2000);

      const updatedText = (!isSeed && updated && !isNaN(updated.getTime()))
        ? `Updated: ${updated.toLocaleString(undefined, fmt)}`
        : "Seed (waiting on feed)";

      setMini("decrypt-updated", updatedText);

      const itemsHtml = items.slice(0, 5).map(it => {
        const title = it?.title || "Untitled";
        const url = it?.url || "#";
        const src = it?.source || "decrypt";
        const st = it?.stamp || "";

        return `
          <a class="item" href="${esc(url)}" target="_blank" rel="noopener">
            <h3>${esc(title)}</h3>
            <div class="meta">
              ${st ? stamp(st) : ""}
              ${stamp(src, "source")}
            </div>
          </a>
        `;
      }).join("");

      root.innerHTML = itemsHtml || `
        <div class="feature">
          <div class="headline">No items</div>
          <div class="sub">Your feed is empty.</div>
          <div class="status">Status: empty</div>
        </div>
      `;
    }

    function renderHNfromHomeJson(home){
      const root = document.getElementById("hn-root");
      const items = home?.sections?.hacker;

      const updated = home?.updated_iso ? new Date(home.updated_iso) : null;
      const updatedText = (updated && !isNaN(updated.getTime()))
        ? `Updated: ${updated.toLocaleString(undefined, fmt)}`
        : "Standby";

      setMini("hn-updated", updatedText);

      if (!Array.isArray(items) || items.length === 0) return;

      root.innerHTML = items.slice(0, 10).map(it => {
        const title = it?.title || "Untitled";
        const url = it?.url || "#";
        return `
          <a class="item" href="${esc(url)}" target="_blank" rel="noopener">
            <h3>${esc(title)}</h3>
            <div class="meta">${stamp("hn", "source")}${stamp("newest")}</div>
          </a>
        `;
      }).join("");
    }

    function setEditionTime(){
      const el = document.getElementById("edition-time");
      if (!el) return;
      const d = new Date();
      el.textContent = `Edition: ${d.toLocaleString(undefined, fmt)}`;
    }

    async function boot(){
      setEditionTime();

      try{
        const projects = await fetchJson(`data/projects.json?${nowBust()}`);
        renderProjects(projects);
      }catch(e){
        setMini("projects-updated", "Error");
        renderError(
          document.getElementById("projects-root"),
          "Projects",
          `Could not load data/projects.json (${e.message}).`
        );
      }

      try{
        const decrypt = await fetchJson(`data/decrypt.json?${nowBust()}`);
        renderDecrypt(decrypt);
      }catch(e){
        setMini("decrypt-updated", "Error");
        renderError(
          document.getElementById("decrypt-root"),
          "Decrypt",
          `Could not load data/decrypt.json (${e.message}).`
        );
      }

      try{
        const home = await fetchJson(`data/home.json?${nowBust()}`);
        renderHNfromHomeJson(home);
      }catch(_e){
        // silent
      }
    }

    boot();
  </script>
</body>
</html>
